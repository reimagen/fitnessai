# FitnessAI

FitnessAI is a modern, AI-powered fitness application designed to be your personal companion for tracking workouts, analyzing progress, and receiving intelligent recommendations. It's built with a modern tech stack to provide a seamless and responsive user experience.

## Core Features

- **Workout Logging**: Easily log your workout sessions, including exercises, sets, reps, and weight.
- **AI-Powered Parsing**: Upload screenshots of your workout logs or personal records, and let the AI automatically parse and save the data.
- **In-Depth Analysis**: Visualize your progress with detailed charts and graphs. Get AI-driven insights into your strength balance to identify and correct imbalances.
- **Lift Progression Analysis**: Track your performance trends for specific exercises over the last 6 weeks. Get AI insights on your estimated 1-Rep Max (e1RM) and volume progression to optimize your training.
- **Personalized Planning**: Receive weekly workout plans generated by an AI that considers your goals, history, and strength analysis.
- **Goal Setting**: Define and track your fitness goals, from weight loss to muscle gain, and see your achievements celebrated.
- **AI-Powered Goal Analysis**: Receive AI-driven feedback on your fitness goals to make them more specific, measurable, achievable, relevant, and time-bound (SMART).
- **Milestone Tracking**: View your personal records (PRs) for each exercise, classified by strength level (Beginner, Intermediate, Advanced, Elite).

## Tech Stack

- **Framework**: [Next.js](https://nextjs.org/) (with App Router)
- **UI Library**: [React](https://react.dev/)
- **Language**: [TypeScript](https://www.typescriptlang.org/)
- **Styling**: [Tailwind CSS](https://tailwindcss.com/)
- **UI Components**: [ShadCN UI](https://ui.shadcn.com/)
- **Database**: [Firebase Firestore](https://firebase.google.com/docs/firestore)
- **AI/Generative**: [Genkit](https://firebase.google.com/docs/genkit) with the Google Gemini API

## Getting Started

To run this project locally, follow these steps:

1.  **Install Dependencies**:
    Open your terminal and run the following command to install the necessary packages.
    ```bash
    npm install
    ```

2.  **Set Up Environment Variables**:
    The application requires Firebase web app config values and an API key for AI features.
    - Create a file named `.env.local` in the root of the project.
    - Add Firebase web app config (from Firebase console -> Project settings -> Web app):
      ```
      NEXT_PUBLIC_FIREBASE_API_KEY=...
      NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN=...
      NEXT_PUBLIC_FIREBASE_PROJECT_ID=...
      NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET=...
      NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=...
      NEXT_PUBLIC_FIREBASE_APP_ID=...
      ```
    - Add a Gemini API Key (or Google API key) for AI features:
      ```
      GEMINI_API_KEY=YOUR_API_KEY_HERE
      # or
      GOOGLE_API_KEY=YOUR_API_KEY_HERE
      ```
    - Optional (production/ops):
      ```
      GOOGLE_CLOUD_PROJECT=YOUR_GCP_PROJECT_ID
      LOG_INFO_SAMPLE_RATE=0.01
      UPSTASH_REDIS_REST_URL=...
      UPSTASH_REDIS_REST_TOKEN=...
      ```

3.  **Run the Development Server**:
    Now you can start the development server.
    ```bash
    npm run dev
    ```

4.  **Open the App**:
    Open [http://localhost:3000](http://localhost:3000) with your browser to see the result.

## Testing

**Unit & Integration Tests**
```bash
npm run test           # Run tests in watch mode
npm run test:ci        # Run tests once (CI mode)
```

**Smoke Tests** (end-to-end user flows)
```bash
# Set up test credentials first
export E2E_AUTH_EMAIL="fake@notreal.com"
export E2E_AUTH_PASSWORD="fake26"

# Run all smoke tests
npm run test:smoke

# Run in headed mode (see browser)
npm run test:smoke:headed
```

**CI/CD Checks**
When you push to `main` or open a PR, the following checks run automatically:
- `lint` - ESLint
- `typecheck` - TypeScript type checking
- `smoke-tests` - End-to-end tests for critical user flows

See `.github/workflows/` for CI configuration and `tests/smoke/README.md` for detailed smoke test documentation.

## Available Pages

The application is organized into the following pages, accessible via the bottom navigation bar:

- **Home**: Dashboard with quick actions and weekly progress summaries.
- **Analysis**: Visualize your workout data, running progression, strength balance, and individual lift progression trends.
- **Milestones (PRs)**: View and upload your personal records (PRs).
- **Plan**: Generate a personalized AI workout plan for the week.
- **History**: Log new workouts or view your past session history.
- **Profile**: Manage your personal details, workout preferences, and fitness goals.

Additional routes:
- **Sign In**: Email/password authentication.
- **Pending**: Auth-gated loading state for session checks.

## Notes

- Exercise library migration is in progress (see `docs/firebase-exercise-lib.md`).
- Firebase App Hosting provides `FIREBASE_WEBAPP_CONFIG` at build time; local dev uses `NEXT_PUBLIC_FIREBASE_*` values.
- Observability:
  - Health check endpoint: `/api/health`
  - Client error reporting endpoint: `/api/client-errors`
  - Cloud Logging log name: `fitnessai`
- Ops runbook: `docs/ops-runbook.md`
